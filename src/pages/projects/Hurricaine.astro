---
import Layout from '../../layout/Layout.astro';

const project = {
  title: "HurricAIne",
  tagline: "Deep learning system that predicts hurricane position 6 hours ahead using atmospheric reanalysis and a custom CNN—from data acquisition to deployable inference.",
  date: "2024",
  role: "ML Engineer & Data Pipeline Architect",
  repoUrl: "https://github.com/crowmoed/HurricAIne---Python",
  stack: ["Python", "TensorFlow/Keras", "xarray", "ERA5 API", "Plotly", "XGBoost"]
};

const githubIcon = `
<svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
  <path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.05-.015-2.07-3.345.72-4.05-1.605-4.05-1.605-.54-1.38-1.335-1.755-1.335-1.755-1.095-.75.09-.735.09-.735 1.215.09 1.845 1.245 1.845 1.245 1.08 1.845 2.835 1.305 3.525.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.225 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405 1.02 0 2.04.135 3 .405 2.295-1.545 3.3-1.23 3.3-1.23.66 1.695.24 2.925.12 3.225.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.285 0 .315.225.69.825.57A12.02 12.02 0 0 0 24 12c0-6.63-5.37-12-12-12z"/>
</svg>`;
---

<Layout title={`${project.title} – Cristiano Pinto`} description={project.tagline} image="/hurricAIne-poster.png">
  <div class="projects-wrapper back">
      
      <header class="detail-header fade-in">
        <a href="/projects" class="back-link">
          <span class="arrow">←</span> All Projects
        </a>
        <h1>{project.title}</h1>
        <p class="tagline">{project.tagline}</p>
      </header>

      <div class="content-grid fade-in-delay">
        
        <main class="project-body">
          <div class="project-hero-image">
             <img src="/hurricAIne-poster.png" alt="HurricAIne project poster" style="width: 100%; height: 100%; display: block;"/>
          </div>

          <div class="text-content">
            <h3>What It Does</h3>
            <p>
              HurricAIne predicts <strong>where a hurricane will be 6 hours from now</strong> using a CNN trained on atmospheric reanalysis. I built the full pipeline: data acquisition, feature engineering, model training, and deployable inference with quantified error.
            </p>
            <p>
              <strong>Bottom line:</strong> ~100–200 km mean absolute error on 6-hour position (best case ~50 km), comparable to interpolated operational guidance. Inference runs in under a second per prediction.
            </p>

            <h3>Results at a Glance</h3>
            <ul>
              <li><strong>Accuracy:</strong> 100–200 km MAE; best predictions ~50 km</li>
              <li><strong>Model size:</strong> ~50k–100k parameters, ~5 MB; trains on CPU in 30–60 min</li>
              <li><strong>Pipeline:</strong> Saved normalization stats and artifacts for one-step inference; full-storm track prediction with error aggregation</li>
              <li><strong>Baseline:</strong> XGBoost on SHIPS (10+ features) as a fast, GPU-free check—CNN wins on accuracy</li>
            </ul>

            <h3>Data Pipeline</h3>
            <p>Two main sources, one window:</p>
            <ul>
              <li><strong>ERA5</strong> (ECMWF)—gridded atmospheric fields, monthly NetCDF via CDS API. In-memory cache with explicit clear after each storm to avoid memory exhaustion.</li>
              <li><strong>HURDAT2</strong> (NOAA)—ground-truth storm positions every 6 hours.</li>
              <li><strong>Windowing:</strong> 70° × 70° box around each storm; robust handling of longitude (ERA5 0–360° vs. HURDAT −180°/180°) and date-line crossings.</li>
            </ul>
            <p>Training: 2020 Atlantic season (31 named storms, ~500 samples). SHIPS and NOAA OISST support the XGBoost baseline and future work.</p>

            <h3>Features & Input</h3>
            <p>Each timestep → one <strong>40 × 40 × 17</strong> tensor:</p>
            <ul>
              <li><strong>5 surface channels:</strong> 10 m wind (u, v), sea-level pressure, SST, total column water vapor</li>
              <li><strong>12 pressure-level channels:</strong> wind + relative humidity at 200, 500, 700, 850 hPa</li>
            </ul>
            <p>Target: displacement in degrees, <code>next_position - current_position</code>. Channel- and target-normalized; stats saved for inference. Defensive checks: filter zero-dimension slices, enforce storm-ID consistency, replace NaNs over land before resize.</p>

            <h3>CNN Architecture</h3>
            <p>Lightweight and attention-aware:</p>
            <ul>
              <li><strong>Separable convolutions</strong>—fewer parameters, same spatial features</li>
              <li><strong>Residual block</strong>—1×1 shortcut + dual separable convs for better gradient flow</li>
              <li><strong>Channel attention</strong>—squeeze-and-excitation; model learns which variables matter (e.g. SST vs. shear)</li>
              <li><strong>Spatial attention</strong>—focus on the relevant quadrant of the storm</li>
              <li><strong>Head:</strong> GlobalAveragePooling → Dense(128) → Dense(64) → Dense(2) → <code>[Δlat, Δlon]</code></li>
            </ul>
            <p>Training: Adam, MSE loss, MAE metric, ReduceLROnPlateau, EarlyStopping with best-weights restore.</p>

            <h3>Inference & Viz</h3>
            <ol>
              <li>Load saved normalization stats and build the feature tensor for the current timestep.</li>
              <li>Forward pass → denormalize → add delta to current position.</li>
              <li>Compute error in km (degree-to-distance conversion).</li>
            </ol>
            <p>Interactive Plotly map: actual vs. predicted tracks, marker size = storm radius, color = intensity (e.g. VMAX).</p>

            <h3>Challenges Solved</h3>
            <ul>
              <li><strong>Memory:</strong> ERA5 ~2–4 GB/month → explicit cache clear after each storm so full seasons run without OOM.</li>
              <li><strong>Coordinates:</strong> One longitude convention and date-line roll in the slicer so ERA5 and HURDAT2 line up in all basins.</li>
              <li><strong>Robustness:</strong> Zero-dim checks and storm-ID verification before resize; NaN handling over land.</li>
            </ul>

            <h3>Wrap-up</h3>
            <p>
              I built HurricAIne over winter break using real scientific data—hundreds of gigabytes of ERA5 reanalysis and HURDAT2 tracks—because I wanted something ambitious and end-to-end. In testing, the model achieved a mean absolute error of about <strong>112 km</strong> on 6-hour position, with some predictions as accurate as <strong>20 km</strong>. The architecture’s attention mechanisms learn which regions of the atmosphere around a storm matter most for the prediction, so in a sense the model discovers what matters on its own.
            </p>
            <p>
              Seeing predicted tracks on a map next to real hurricane paths was the payoff for all the pipeline debugging and long runtimes. What surprised me was how much of the work had nothing to do with the neural network: most of the time went into aligning position records with multi-dimensional weather data, handling coordinate systems (especially near the date line), and structuring everything correctly before the model ever saw it.
            </p>
            <p>
              <strong>Next steps:</strong> expanding the dataset across multiple years and trying time-based models (e.g. recurrent layers) to improve accuracy. I’m happy to discuss the technical details or collaborate—reach out if you’d like to talk.
            </p>
          </div>
        </main>

        <aside class="project-sidebar">
          
          <div class="meta-block">
            <span class="meta-label">Role</span>
            <span class="meta-value">{project.role}</span>
          </div>

          <div class="meta-block">
            <span class="meta-label">Timeline</span>
            <span class="meta-value">{project.date}</span>
          </div>

          <div class="meta-block">
            <span class="meta-label">Stack</span>
            <div class="tech-stack-wrap">
              {project.stack.map(tech => (
                <span class="tech-tag">{tech}</span>
              ))}
            </div>
          </div>

          <div class="meta-block">
            <span class="meta-label">Data Sources</span>
            <div class="tech-stack-wrap">
              <span class="tech-tag">ERA5</span>
              <span class="tech-tag">HURDAT2</span>
              <span class="tech-tag">NOAA OISST</span>
              <span class="tech-tag">SHIPS</span>
            </div>
          </div>

          <div class="meta-block">
            <span class="meta-label">Output</span>
            <span class="meta-value">6-hour displacement (Δlat, Δlon)</span>
          </div>

          <div class="meta-block">
            <span class="meta-label">Input Shape</span>
            <span class="meta-value">(40, 40, 17)</span>
          </div>

          <div class="action-buttons">
            <a href={project.repoUrl} target="_blank" rel="noopener noreferrer" class="action-btn outline">
              <span class="icon" set:html={githubIcon} />
              View Code
            </a>
          </div>

        </aside>


    </div>
  </div>
</Layout>